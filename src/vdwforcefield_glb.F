#include "symbol.inc"

      MODULE tim_parameters
         USE prec
!          USE base
!          USE poscar
!          USE lattice
         USE constant

         CONTAINS
         
         !> compute polarizability for ion with integral charge
         SUBROUTINE give_alpha0(a1,a2,o1,o2,omega,alpha0)
           REAL(q) :: a1,a2,o1,o2,omega
           REAL(q) :: alpha0
      
           alpha0=a1/(o1*o1+omega*omega)+a2/(o2*o2+omega*omega)                  
         END SUBROUTINE give_alpha0

         !> compute polarizability for ion with partial charge
         SUBROUTINE give_alpha(a11,a12,a21,a22,o11,o12,o21,o22,f,omega,alpha)
           REAL(q) :: a11,a12,a21,a22,o11,o12,o21,o22,f,omega
           REAL(q) :: alpha1,alpha2,alpha
           
           CALL give_alpha0(a11,a12,o11,o12,omega,alpha1)
           CALL give_alpha0(a21,a22,o21,o22,omega,alpha2)           
           alpha=(1.-f)*alpha1+f*alpha2
         END SUBROUTINE give_alpha
         
         
         
         !> compute c6 coeficient for partialy charged atom
         SUBROUTINE give_c6(a11,a12,a21,a22,o11,o12,o21,o22,f,c6x)
           REAL(q) :: a11,a12,a21,a22,o11,o12,o21,o22,f,c6x
           REAL(q) :: a1_(2),a2_(2),o1_(2),o2_(2)
           INTEGER :: c,cp
  
           !c A
           a1_(1)=a11;a1_(2)=a12
           o1_(1)=o11;o1_(2)=o12

           !c A+
           a2_(1)=a21;a2_(2)=a22
           o2_(1)=o21;o2_(2)=o22

           c6x=0._q
           DO c =1,2
             DO cp=1,2
               c6x=c6x+f*f*a2_(c)*a2_(cp)/(o2_(c)*o2_(cp)*(o2_(c)+o2_(cp)))
               c6x=c6x+(1.-f)*(1.-f)*a1_(c)*a1_(cp)/(o1_(c)*o1_(cp)*(o1_(c)+o1_(cp)))
               c6x=c6x+(1.-f)*f*a1_(c)*a2_(cp)/(o1_(c)*o2_(cp)*(o1_(c)+o2_(cp)))
               c6x=c6x+f*(1.-f)*a2_(c)*a1_(cp)/(o2_(c)*o1_(cp)*(o2_(c)+o1_(cp)))
             ENDDO
           ENDDO
           
           c6x=c6x*1.5
         
         END SUBROUTINE give_c6
 
         !> computes scaled alpha and optionally (LallPARAM=.TRUE.) also c6 and 
         !> r0 using ionic parameters of Tim Gould 
         SUBROUTINE DEF_PARAM(LallPARAM,flag,charge,relvol,r0,r0new,alpha,c6,omega)
           !USE prec
           USE tutor, ONLY: vtutor
           !INTEGER :: IU
           CHARACTER (LEN=2) :: flag
           REAL(q) :: CHARGE,RELVOL,R0,R0new,omega
           INTEGER :: REF_CHG(5)
           LOGICAL :: LREF_CHG(5)
           REAL(q) :: a1(5),a2(5),o1(5),o2(5)
           REAL(q) :: f,alpha0,alpha,c6   
           INTEGER :: oxmin,oxmax,indx1,indx2
           LOGICAL :: LallPARAM

           LREF_CHG=.FALSE.
           REF_CHG=(/-1,0,1,2,3/)
           a1=0._q; a2=0._q; o1=0._q; o2=0._q


           SELECT CASE(flag)
            CASE("H ")
              LREF_CHG(1:3)=.TRUE.
              a1(3)=0.0;o1(3)=1.0;a2(3)=0.0;o2(3)=1.0
              a1(2)=0.6825;o1(2)=0.4037;a2(2)=0.3175;o2(2)=1.0098
              a1(1)=1.2407;o1(1)=0.4301;a2(1)=0.7593;o2(1)=1.0672
            CASE("He")
              LREF_CHG(2:3)=.TRUE.
              a1(3)=0.6812;o1(3)=1.5787;a2(3)=0.3188;o2(3)=3.9325
              a1(2)=1.0856;o1(2)=0.9359;a2(2)=0.9144;o2(2)=2.5508
            CASE("Li")
              LREF_CHG(1:4)=.TRUE.
              a1(4)=0.8075;o1(4)=3.7968;a2(4)=0.1925;o2(4)=15.913
              a1(3)=1.1925;o1(3)=2.6059;a2(3)=0.8075;o2(3)=6.8125
              a1(2)=0.786;o1(2)=0.0693;a2(2)=2.214;o2(2)=2.1502
              a1(1)=1.6087;o1(1)=0.1;a2(1)=2.3913;o2(1)=1.9523
            CASE("Be")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=0.9989;o1(5)=8.3896;a2(5)=0.0011;o2(5)=43.3079
              a1(4)=1.9663;o1(4)=12.8238;a2(4)=0.0337;o2(4)=27.9589
              a1(3)=0.5688;o1(3)=0.1531;a2(3)=2.4312;o2(3)=3.1924
              a1(2)=1.4767;o1(2)=0.1984;a2(2)=2.5233;o2(2)=3.6141
            CASE("B ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.9986;o1(5)=11.5815;a2(5)=0.0014;o2(5)=48.2565
              a1(4)=0.4234;o1(4)=0.275;a2(4)=2.5766;o2(4)=5.3578
              a1(3)=1.1775;o1(3)=0.3512;a2(3)=2.8225;o2(3)=4.795
              a1(2)=1.9004;o1(2)=0.3067;a2(2)=3.0996;o2(2)=3.2165
              a1(1)=2.4251;o1(1)=0.2745;a2(1)=3.5749;o2(1)=2.1685
            CASE("C ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=0.3295;o1(5)=0.3512;a2(5)=2.6705;o2(5)=7.0831
              a1(4)=0.9269;o1(4)=0.4966;a2(4)=3.0731;o2(4)=6.1607
              a1(3)=1.5022;o1(3)=0.5236;a2(3)=3.4978;o2(3)=4.4052
              a1(2)=2.2621;o1(2)=0.446;a2(2)=3.7379;o2(2)=3.3797
              a1(1)=2.7393;o1(1)=0.4289;a2(1)=4.2607;o2(1)=2.7043
            CASE("N ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=0.7442;o1(5)=0.6073;a2(5)=3.2558;o2(5)=7.5332
              a1(4)=1.1045;o1(4)=0.6931;a2(4)=3.8955;o2(4)=5.4584
              a1(3)=1.8414;o1(3)=0.7267;a2(3)=4.1586;o2(3)=4.6452
              a1(2)=2.5922;o1(2)=0.6111;a2(2)=4.4078;o2(2)=3.7758
              a1(1)=3.0246;o1(1)=0.6305;a2(1)=4.9754;o2(1)=3.4029
            CASE("O ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=0.8357;o1(5)=0.7397;a2(5)=4.1643;o2(5)=6.0441
              a1(4)=1.3355;o1(4)=0.9364;a2(4)=4.6645;o2(4)=5.6323
              a1(3)=2.2652;o1(3)=0.9759;a2(3)=4.7348;o2(3)=5.251
              a1(2)=2.7732;o1(2)=0.7534;a2(2)=5.2268;o2(2)=4.0761
              a1(1)=3.1213;o1(1)=0.7893;a2(1)=5.8787;o2(1)=3.8957
            CASE("F ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=0.9706;o1(5)=1.0038;a2(5)=5.0294;o2(5)=6.2811
              a1(4)=1.7248;o1(4)=1.2598;a2(4)=5.2752;o2(4)=6.2917
              a1(3)=2.8302;o1(3)=1.3079;a2(3)=5.1698;o2(3)=6.4189
              a1(2)=2.945;o1(2)=0.9413;a2(2)=6.055;o2(2)=4.6821
              a1(1)=1.7195;o1(1)=0.3597;a2(1)=8.2805;o2(1)=2.2023
            CASE("Ne")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=1.2529;o1(5)=1.3919;a2(5)=5.7471;o2(5)=7.0406
              a1(4)=2.4999;o1(4)=1.7014;a2(4)=5.5001;o2(4)=7.6366
              a1(3)=3.4082;o1(3)=1.5946;a2(3)=5.5918;o2(3)=7.3857
              a1(2)=3.1603;o1(2)=1.1397;a2(2)=6.8397;o2(2)=5.3709
            CASE("Na")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0271;o1(5)=2.2781;a2(5)=5.9729;o2(5)=9.6947
              a1(4)=3.4605;o1(4)=2.4981;a2(4)=5.5395;o2(4)=10.7596
              a1(3)=4.0189;o1(3)=2.1561;a2(3)=5.9811;o2(3)=9.5547
              a1(2)=0.9798;o1(2)=0.0777;a2(2)=10.0202;o2(2)=3.5645
              a1(1)=1.9219;o1(1)=0.0991;a2(1)=10.0781;o2(1)=3.3345
            CASE("Mg")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=5.6814;o1(5)=13.6347;a2(5)=3.3186;o2(5)=3.39
              a1(4)=5.4365;o1(4)=14.5651;a2(4)=4.5635;o2(4)=3.3594
              a1(3)=0.9379;o1(3)=0.1647;a2(3)=10.0621;o2(3)=4.8647
              a1(2)=1.8727;o1(2)=0.1624;a2(2)=10.1273;o2(2)=4.8672
            CASE("Al")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=5.0987;o1(5)=21.1055;a2(5)=4.9013;o2(5)=4.9717
              a1(4)=0.8739;o1(4)=0.2921;a2(4)=10.1261;o2(4)=7.3424
              a1(3)=1.8117;o1(3)=0.3057;a2(3)=10.1883;o2(3)=7.2336
              a1(2)=2.4419;o1(2)=0.2068;a2(2)=10.5581;o2(2)=5.1776
              a1(1)=3.1773;o1(1)=0.171;a2(1)=10.8227;o2(1)=3.8515
            CASE("Si")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=0.8081;o1(5)=0.3902;a2(5)=10.1919;o2(5)=9.1571
              a1(4)=1.6977;o1(4)=0.4278;a2(4)=10.3023;o2(4)=8.9974
              a1(3)=2.5386;o1(3)=0.3749;a2(3)=10.4614;o2(3)=8.3522
              a1(2)=3.2254;o1(2)=0.2962;a2(2)=10.7746;o2(2)=6.5942
              a1(1)=3.9664;o1(1)=0.2589;a2(1)=11.0336;o2(1)=5.2134
            CASE("P ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.578;o1(5)=0.5406;a2(5)=10.422;o2(5)=10.7251
              a1(4)=2.3731;o1(4)=0.5176;a2(4)=10.6269;o2(4)=10.026
              a1(3)=3.2288;o1(3)=0.4778;a2(3)=10.7712;o2(3)=9.4439
              a1(2)=3.9364;o1(2)=0.3999;a2(2)=11.0636;o2(2)=7.8376
              a1(1)=4.626;o1(1)=0.372;a2(1)=11.374;o2(1)=6.3845
            CASE("S ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.1793;o1(5)=0.6213;a2(5)=10.8207;o2(5)=11.0435
              a1(4)=3.0191;o1(4)=0.613;a2(4)=10.9809;o2(4)=10.6074
              a1(3)=3.8887;o1(3)=0.5738;a2(3)=11.1113;o2(3)=10.1104
              a1(2)=4.4693;o1(2)=0.481;a2(2)=11.5307;o2(2)=8.0336
              a1(1)=5.1213;o1(1)=0.4631;a2(1)=11.8787;o2(1)=6.9618
            CASE("Cl")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7766;o1(5)=0.7524;a2(5)=11.2234;o2(5)=11.8885
              a1(4)=3.6551;o1(4)=0.7443;a2(4)=11.3449;o2(4)=11.6315
              a1(3)=4.5137;o1(3)=0.7014;a2(3)=11.4863;o2(3)=11.0533
              a1(2)=5.0208;o1(2)=0.5876;a2(2)=11.9792;o2(2)=8.7396
              a1(1)=4.3597;o1(1)=0.384;a2(1)=13.6403;o2(1)=4.3097
            CASE("Ar")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=3.3808;o1(5)=0.9113;a2(5)=11.6192;o2(5)=12.9658
              a1(4)=4.3116;o1(4)=0.9106;a2(4)=11.6884;o2(4)=12.9025
              a1(3)=5.1219;o1(3)=0.8438;a2(3)=11.8781;o2(3)=12.0348
              a1(2)=5.583;o1(2)=0.7136;a2(2)=12.417;o2(2)=9.5878
            CASE("K ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=4.0408;o1(5)=1.1771;a2(5)=11.9592;o2(5)=15.2897
              a1(4)=4.954;o1(4)=1.1498;a2(4)=12.046;o2(4)=15.0624
              a1(3)=5.7291;o1(3)=1.0717;a2(3)=12.2709;o2(3)=14.0876
              a1(2)=1.0429;o1(2)=0.0603;a2(2)=17.9571;o2(2)=2.2869
              a1(1)=2.0406;o1(1)=0.0735;a2(1)=17.9594;o2(1)=2.0961
            CASE("Ca")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=4.6979;o1(5)=1.3467;a2(5)=12.3021;o2(5)=16.3816
              a1(4)=5.5966;o1(4)=1.3644;a2(4)=12.4034;o2(4)=16.8334
              a1(3)=1.0879;o1(3)=0.1217;a2(3)=17.9121;o2(3)=2.978
              a1(2)=2.0345;o1(2)=0.1137;a2(2)=17.9655;o2(2)=2.9077
            CASE("Sc")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=5.3554;o1(5)=1.5486;a2(5)=12.6446;o2(5)=17.8124
              a1(4)=1.1062;o1(4)=0.187;a2(4)=17.8938;o2(4)=3.8376
              a1(3)=2.0831;o1(3)=0.1883;a2(3)=17.9169;o2(3)=3.8058
              a1(2)=2.1582;o1(2)=0.1336;a2(2)=18.8418;o2(2)=3.0215
              a1(1)=2.2944;o1(1)=0.1323;a2(1)=19.7056;o2(1)=2.6705
            CASE("Ti")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.1103;o1(5)=0.2523;a2(5)=17.8897;o2(5)=4.7438
              a1(4)=2.0655;o1(4)=0.2607;a2(4)=17.9345;o2(4)=4.7243
              a1(3)=1.3256;o1(3)=0.1756;a2(3)=19.6744;o2(3)=3.4516
              a1(2)=2.1944;o1(2)=0.1481;a2(2)=19.8056;o2(2)=3.2022
              a1(1)=2.289;o1(1)=0.1461;a2(1)=20.711;o2(1)=2.8977
            CASE("V ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0251;o1(5)=0.3338;a2(5)=17.9749;o2(5)=5.7168
              a1(4)=2.0861;o1(4)=0.2838;a2(4)=18.9139;o2(4)=5.0064
              a1(3)=1.3656;o1(3)=0.1974;a2(3)=20.6344;o2(3)=3.7291
              a1(2)=2.1868;o1(2)=0.1599;a2(2)=20.8132;o2(2)=3.4139
              a1(1)=2.2518;o1(1)=0.1562;a2(1)=21.7482;o2(1)=3.1158
            CASE("Cr")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.1549;o1(5)=0.2732;a2(5)=19.8451;o2(5)=4.8373
              a1(4)=1.2406;o1(4)=0.2354;a2(4)=20.7594;o2(4)=4.2194
              a1(3)=1.3825;o1(3)=0.1944;a2(3)=21.6175;o2(3)=3.6066
              a1(2)=1.5333;o1(2)=0.1422;a2(2)=22.4667;o2(2)=2.929
              a1(1)=2.2098;o1(1)=0.1647;a2(1)=22.7902;o2(1)=3.3468
            CASE("Mn")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0292;o1(5)=0.3865;a2(5)=19.9708;o2(5)=6.4832
              a1(4)=2.1011;o1(4)=0.3305;a2(4)=20.8989;o2(4)=5.7337
              a1(3)=1.3865;o1(3)=0.2375;a2(3)=22.6135;o2(3)=4.3845
              a1(2)=2.1365;o1(2)=0.1808;a2(2)=22.8635;o2(2)=3.9456
              a1(1)=2.1669;o1(1)=0.1724;a2(1)=23.8331;o2(1)=3.6032
            CASE("Fe")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0271;o1(5)=0.4054;a2(5)=20.9729;o2(5)=6.7802
              a1(4)=2.1004;o1(4)=0.3469;a2(4)=21.8996;o2(4)=6.0174
              a1(3)=1.4022;o1(3)=0.2521;a2(3)=23.5978;o2(3)=4.6337
              a1(2)=2.1353;o1(2)=0.1902;a2(2)=23.8647;o2(2)=4.1427
              a1(1)=2.1621;o1(1)=0.1827;a2(1)=24.8379;o2(1)=3.8366
            CASE("Co")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0296;o1(5)=0.4293;a2(5)=21.9704;o2(5)=7.2467
              a1(4)=2.1036;o1(4)=0.3675;a2(4)=22.8964;o2(4)=6.457
              a1(3)=1.4124;o1(3)=0.2685;a2(3)=24.5876;o2(3)=4.9791
              a1(2)=2.1348;o1(2)=0.2014;a2(2)=24.8652;o2(2)=4.4716
              a1(1)=2.1584;o1(1)=0.1925;a2(1)=25.8416;o2(1)=4.1409
            CASE("Ni")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0291;o1(5)=0.4536;a2(5)=22.9709;o2(5)=7.7181
              a1(4)=2.1117;o1(4)=0.3898;a2(4)=23.8883;o2(4)=6.8741
              a1(3)=1.4139;o1(3)=0.2839;a2(3)=25.5861;o2(3)=5.3297
              a1(2)=2.1268;o1(2)=0.2121;a2(2)=25.8732;o2(2)=4.785
              a1(1)=2.1475;o1(1)=0.2017;a2(1)=26.8525;o2(1)=4.4247
            CASE("Cu")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.2071;o1(5)=0.419;a2(5)=24.7929;o2(5)=7.2679
              a1(4)=1.3095;o1(4)=0.3627;a2(4)=25.6905;o2(4)=6.4322
              a1(3)=1.4125;o1(3)=0.2909;a2(3)=26.5875;o2(3)=5.5337
              a1(2)=1.3938;o1(2)=0.1861;a2(2)=27.6062;o2(2)=4.3864
              a1(1)=2.136;o1(1)=0.2109;a2(1)=27.864;o2(1)=4.7195
            CASE("Zn")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0388;o1(5)=0.5153;a2(5)=24.9612;o2(5)=8.8483
              a1(4)=2.1232;o1(4)=0.4429;a2(4)=25.8768;o2(4)=7.915
              a1(3)=2.1806;o1(3)=0.3545;a2(3)=26.8194;o2(3)=6.8787
              a1(2)=2.1031;o1(2)=0.2368;a2(2)=27.8969;o2(2)=5.5499
              a1(1)=0.7625;o1(1)=0.0305;a2(1)=30.2375;o2(1)=1.0822
            CASE("Ga")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.1617;o1(5)=0.3831;a2(5)=25.8383;o2(5)=7.1449
              a1(4)=2.1712;o1(4)=0.3839;a2(4)=26.8288;o2(4)=7.3601
              a1(3)=2.1803;o1(3)=0.3847;a2(3)=27.8197;o2(3)=7.5738
              a1(2)=2.3789;o1(2)=0.2156;a2(2)=28.6211;o2(2)=5.6285
              a1(1)=3.0888;o1(1)=0.1742;a2(1)=28.9112;o2(1)=4.5182
            CASE("Ge")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.1218;o1(5)=0.4922;a2(5)=26.8782;o2(5)=8.7545
              a1(4)=2.1322;o1(4)=0.4933;a2(4)=27.8678;o2(4)=9.0081
              a1(3)=2.9125;o1(3)=0.4015;a2(3)=28.0875;o2(3)=8.4117
              a1(2)=3.3873;o1(2)=0.2924;a2(2)=28.6127;o2(2)=7.0292
              a1(1)=4.1616;o1(1)=0.258;a2(1)=28.8384;o2(1)=5.9974
            CASE("As")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.0543;o1(5)=0.6006;a2(5)=27.9457;o2(5)=10.5906
              a1(4)=2.9466;o1(4)=0.5523;a2(4)=28.0534;o2(4)=10.2779
              a1(3)=3.7618;o1(3)=0.4827;a2(3)=28.2382;o2(3)=9.7484
              a1(2)=4.3165;o1(2)=0.3845;a2(2)=28.6835;o2(2)=8.5002
              a1(1)=5.0713;o1(1)=0.3583;a2(1)=28.9287;o2(1)=7.3464
            CASE("Se")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8693;o1(5)=0.6451;a2(5)=28.1307;o2(5)=11.2188
              a1(4)=3.783;o1(4)=0.6093;a2(4)=28.217;o2(4)=10.9803
              a1(3)=4.6076;o1(3)=0.5462;a2(3)=28.3924;o2(3)=10.4845
              a1(2)=5.0009;o1(2)=0.44;a2(2)=28.9991;o2(2)=8.9124
              a1(1)=5.7322;o1(1)=0.428;a2(1)=29.2678;o2(1)=8.1621
            CASE("Br")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.697;o1(5)=0.7371;a2(5)=28.303;o2(5)=12.338
              a1(4)=4.6205;o1(4)=0.7002;a2(4)=28.3795;o2(4)=12.124
              a1(3)=5.3694;o1(3)=0.6324;a2(3)=28.6306;o2(3)=11.4591
              a1(2)=5.7315;o1(2)=0.5188;a2(2)=29.2685;o2(2)=9.7717
              a1(1)=5.1091;o1(1)=0.3486;a2(1)=30.8909;o2(1)=6.315
            CASE("Kr")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=4.5323;o1(5)=0.8684;a2(5)=28.4677;o2(5)=13.9859
              a1(4)=5.4326;o1(4)=0.8304;a2(4)=28.5674;o2(4)=13.7366
              a1(3)=6.14;o1(3)=0.748;a2(3)=28.86;o2(3)=12.8988
              a1(2)=6.4911;o1(2)=0.6261;a2(2)=29.5089;o2(2)=11.0857
            CASE("Rb")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=5.3733;o1(5)=1.1094;a2(5)=28.6267;o2(5)=17.1217
              a1(4)=6.2393;o1(4)=1.0488;a2(4)=28.7607;o2(4)=16.709
              a1(3)=6.9204;o1(3)=0.919;a2(3)=29.0796;o2(3)=15.1742
              a1(2)=1.1214;o1(2)=0.0598;a2(2)=35.8786;o2(2)=3.0336
              a1(1)=2.1777;o1(1)=0.0688;a2(1)=35.8223;o2(1)=2.715
            CASE("Sr")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=6.2048;o1(5)=1.1908;a2(5)=28.7952;o2(5)=17.7901
              a1(4)=7.0465;o1(4)=1.1396;a2(4)=28.9535;o2(4)=17.5745
              a1(3)=1.2836;o1(3)=0.1209;a2(3)=35.7164;o2(3)=3.8511
              a1(2)=2.2204;o1(2)=0.1066;a2(2)=35.7796;o2(2)=3.7041
            CASE("Y ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=7.0336;o1(5)=1.2537;a2(5)=28.9664;o2(5)=18.2512
              a1(4)=1.4135;o1(4)=0.1759;a2(4)=35.5865;o2(4)=4.5537
              a1(3)=2.4068;o1(3)=0.167;a2(3)=35.5932;o2(3)=4.4986
              a1(2)=2.517;o1(2)=0.1254;a2(2)=36.483;o2(2)=3.5614
              a1(1)=2.8007;o1(1)=0.1279;a2(1)=37.1993;o2(1)=3.1721
            CASE("Zr")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.5169;o1(5)=0.2386;a2(5)=35.4831;o2(5)=5.4867
              a1(4)=2.5089;o1(4)=0.2303;a2(4)=35.4911;o2(4)=5.4438
              a1(3)=1.9831;o1(3)=0.1821;a2(3)=37.0169;o2(3)=4.0671
              a1(2)=1.9616;o1(2)=0.1344;a2(2)=38.0384;o2(2)=3.3339
              a1(1)=2.9765;o1(1)=0.1506;a2(1)=38.0235;o2(1)=3.4179
            CASE("Nb")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.5693;o1(5)=0.2814;a2(5)=35.4307;o2(5)=6.1522
              a1(4)=2.7012;o1(4)=0.2484;a2(4)=36.2988;o2(4)=5.3211
              a1(3)=2.1691;o1(3)=0.2023;a2(3)=37.8309;o2(3)=4.0835
              a1(2)=2.0105;o1(2)=0.1459;a2(2)=38.9895;o2(2)=3.3469
              a1(1)=2.9482;o1(1)=0.1634;a2(1)=39.0518;o2(1)=3.519
            CASE("Mo")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.9502;o1(5)=0.3001;a2(5)=37.0498;o2(5)=5.5807
              a1(4)=2.1175;o1(4)=0.2664;a2(4)=37.8825;o2(4)=4.8871
              a1(3)=2.2584;o1(3)=0.223;a2(3)=38.7416;o2(3)=4.1959
              a1(2)=2.251;o1(2)=0.164;a2(2)=39.749;o2(2)=3.4143
              a1(1)=2.8419;o1(1)=0.171;a2(1)=40.1581;o2(1)=3.594
            CASE("Tc")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8072;o1(5)=0.3725;a2(5)=37.1928;o2(5)=7.0398
              a1(4)=2.8707;o1(4)=0.3249;a2(4)=38.1293;o2(4)=6.1337
              a1(3)=2.2767;o1(3)=0.271;a2(3)=39.7233;o2(3)=4.8596
              a1(2)=2.6221;o1(2)=0.1842;a2(2)=40.3779;o2(2)=4.138
              a1(1)=2.7026;o1(1)=0.1757;a2(1)=41.2974;o2(1)=3.6932
            CASE("Ru")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8568;o1(5)=0.3975;a2(5)=38.1432;o2(5)=7.16
              a1(4)=2.8859;o1(4)=0.3444;a2(4)=39.1141;o2(4)=6.2587
              a1(3)=2.8259;o1(3)=0.2783;a2(3)=40.1741;o2(3)=5.3282
              a1(2)=2.5712;o1(2)=0.1917;a2(2)=41.4288;o2(2)=4.2577
              a1(1)=2.6325;o1(1)=0.182;a2(1)=42.3675;o2(1)=3.8186
            CASE("Rh")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8751;o1(5)=0.4198;a2(5)=39.1249;o2(5)=7.296
              a1(4)=2.8732;o1(4)=0.3615;a2(4)=40.1268;o2(4)=6.3989
              a1(3)=2.8006;o1(3)=0.2912;a2(3)=41.1994;o2(3)=5.4747
              a1(2)=2.5098;o1(2)=0.1977;a2(2)=42.4902;o2(2)=4.3922
              a1(1)=2.556;o1(1)=0.187;a2(1)=43.444;o2(1)=3.9562
            CASE("Pd")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8709;o1(5)=0.4399;a2(5)=40.1291;o2(5)=7.4499
              a1(4)=2.8601;o1(4)=0.3783;a2(4)=41.1399;o2(4)=6.5635
              a1(3)=2.7614;o1(3)=0.3026;a2(3)=42.2386;o2(3)=5.6348
              a1(2)=2.4453;o1(2)=0.2026;a2(2)=43.5547;o2(2)=4.5428
              a1(1)=2.4796;o1(1)=0.1912;a2(1)=44.5204;o2(1)=4.1073
            CASE("Ag")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.1964;o1(5)=0.5091;a2(5)=41.8036;o2(5)=7.7447
              a1(4)=2.1549;o1(4)=0.4289;a2(4)=42.8451;o2(4)=6.8055
              a1(3)=1.9861;o1(3)=0.3264;a2(3)=44.0139;o2(3)=5.7788
              a1(2)=1.5368;o1(2)=0.187;a2(2)=45.4632;o2(2)=4.5003
              a1(1)=2.4075;o1(1)=0.1947;a2(1)=45.5925;o2(1)=4.2724
            CASE("Cd")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8436;o1(5)=0.5157;a2(5)=42.1564;o2(5)=8.4402
              a1(4)=2.7994;o1(4)=0.4398;a2(4)=43.2006;o2(4)=7.4862
              a1(3)=2.6628;o1(3)=0.3473;a2(3)=44.3372;o2(3)=6.4754
              a1(2)=2.3227;o1(2)=0.227;a2(2)=45.6773;o2(2)=5.2807
              a1(1)=0.9612;o1(1)=0.0338;a2(1)=48.0388;o2(1)=1.5017
            CASE("In")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8163;o1(5)=0.5513;a2(5)=43.1837;o2(5)=8.9429
              a1(4)=2.7589;o1(4)=0.4684;a2(4)=44.2411;o2(4)=7.9589
              a1(3)=2.61;o1(3)=0.3678;a2(3)=45.39;o2(3)=6.9107
              a1(2)=2.6699;o1(2)=0.2099;a2(2)=46.3301;o2(2)=5.5424
              a1(1)=3.4077;o1(1)=0.1614;a2(1)=46.5923;o2(1)=4.3773
            CASE("Sn")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7841;o1(5)=0.5166;a2(5)=44.2159;o2(5)=8.3437
              a1(4)=2.7163;o1(4)=0.4374;a2(4)=45.2837;o2(4)=7.4499
              a1(3)=3.3356;o1(3)=0.3438;a2(3)=45.6644;o2(3)=6.8874
              a1(2)=3.7426;o1(2)=0.2524;a2(2)=46.2574;o2(2)=6.036
              a1(1)=4.5586;o1(1)=0.2283;a2(1)=46.4414;o2(1)=5.4056
            CASE("Sb")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7486;o1(5)=0.5496;a2(5)=45.2514;o2(5)=8.8727
              a1(4)=3.5416;o1(4)=0.4836;a2(4)=45.4584;o2(4)=8.5046
              a1(3)=4.2698;o1(3)=0.415;a2(3)=45.7302;o2(3)=8.0546
              a1(2)=4.7705;o1(2)=0.3326;a2(2)=46.2295;o2(2)=7.2738
              a1(1)=5.5973;o1(1)=0.3093;a2(1)=46.4027;o2(1)=6.4009
            CASE("Te")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.6097;o1(5)=0.5666;a2(5)=45.3903;o2(5)=9.2444
              a1(4)=4.4688;o1(4)=0.5214;a2(4)=45.5312;o2(4)=8.9842
              a1(3)=5.2253;o1(3)=0.4621;a2(3)=45.7747;o2(3)=8.5797
              a1(2)=5.5653;o1(2)=0.3768;a2(2)=46.4347;o2(2)=7.6354
              a1(1)=6.3646;o1(1)=0.3635;a2(1)=46.6354;o2(1)=7.0701
            CASE("I ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=4.5436;o1(5)=0.6338;a2(5)=45.4564;o2(5)=10.1325
              a1(4)=5.4206;o1(4)=0.5909;a2(4)=45.5794;o2(4)=9.8935
              a1(3)=6.1056;o1(3)=0.5318;a2(3)=45.8944;o2(3)=9.4128
              a1(2)=6.4123;o1(2)=0.4412;a2(2)=46.5877;o2(2)=8.3802
              a1(1)=5.8609;o1(1)=0.3114;a2(1)=48.1391;o2(1)=6.2987
            CASE("Xe")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=5.5036;o1(5)=0.7274;a2(5)=45.4964;o2(5)=11.3585
              a1(4)=6.3624;o1(4)=0.688;a2(4)=45.6376;o2(4)=11.12
              a1(3)=6.9992;o1(3)=0.6185;a2(3)=46.0008;o2(3)=10.519
              a1(2)=7.2968;o1(2)=0.523;a2(2)=46.7032;o2(2)=9.4043
            CASE("Cs")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=6.4954;o1(5)=0.9739;a2(5)=45.5046;o2(5)=14.8134
              a1(4)=7.3059;o1(4)=0.9131;a2(4)=45.6941;o2(4)=14.4205
              a1(3)=7.9165;o1(3)=0.7342;a2(3)=46.0835;o2(3)=12.1313
              a1(2)=1.1667;o1(2)=0.0546;a2(2)=53.8333;o2(2)=3.2491
              a1(1)=2.2659;o1(1)=0.0591;a2(1)=53.7341;o2(1)=2.7274
            CASE("Ba")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=7.4671;o1(5)=0.9768;a2(5)=45.5329;o2(5)=14.5625
              a1(4)=8.2468;o1(4)=0.92;a2(4)=45.7532;o2(4)=14.2144
              a1(3)=1.4022;o1(3)=0.1091;a2(3)=53.5978;o2(3)=3.9825
              a1(2)=2.3372;o1(2)=0.0923;a2(2)=53.6628;o2(2)=3.699
            CASE("La")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=8.4338;o1(5)=1.1924;a2(5)=45.5662;o2(5)=17.5054
              a1(4)=1.6129;o1(4)=0.1795;a2(4)=53.3871;o2(4)=5.2051
              a1(3)=2.6011;o1(3)=0.168;a2(3)=53.3989;o2(3)=5.1362
              a1(2)=2.3275;o1(2)=0.1051;a2(2)=54.6725;o2(2)=4.2194
              a1(1)=2.3318;o1(1)=0.0862;a2(1)=55.6682;o2(1)=3.4085
            CASE("Ce")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=1.7948;o1(5)=0.2475;a2(5)=53.2052;o2(5)=6.2406
              a1(4)=2.7751;o1(4)=0.2332;a2(4)=53.2249;o2(4)=6.1655
              a1(3)=2.5862;o1(3)=0.1722;a2(3)=54.4138;o2(3)=5.3163
              a1(2)=2.3107;o1(2)=0.107;a2(2)=55.6893;o2(2)=4.3811
              a1(1)=2.3132;o1(1)=0.0872;a2(1)=56.6868;o2(1)=3.5328
            CASE("Pr")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.9;o1(5)=0.2837;a2(5)=53.1;o2(5)=6.8375
              a1(4)=2.7583;o1(4)=0.2271;a2(4)=54.2417;o2(4)=6.063
              a1(3)=2.572;o1(3)=0.1678;a2(3)=55.428;o2(3)=5.24
              a1(2)=2.3025;o1(2)=0.104;a2(2)=56.6975;o2(2)=4.3352
              a1(1)=2.305;o1(1)=0.0885;a2(1)=57.695;o2(1)=3.6625
            CASE("Nd")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8832;o1(5)=0.2889;a2(5)=54.1168;o2(5)=7.0314
              a1(4)=2.7429;o1(4)=0.2313;a2(4)=55.2571;o2(4)=6.2413
              a1(3)=2.5588;o1(3)=0.1708;a2(3)=56.4412;o2(3)=5.4042
              a1(2)=2.2937;o1(2)=0.1056;a2(2)=57.7063;o2(2)=4.4825
              a1(1)=2.2956;o1(1)=0.0898;a2(1)=58.7044;o2(1)=3.7899
            CASE("Pm")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8679;o1(5)=0.295;a2(5)=55.1321;o2(5)=7.2626
              a1(4)=2.729;o1(4)=0.2362;a2(4)=56.271;o2(4)=6.4526
              a1(3)=2.5469;o1(3)=0.1743;a2(3)=57.4531;o2(3)=5.5965
              a1(2)=2.2851;o1(2)=0.1076;a2(2)=58.7149;o2(2)=4.6509
              a1(1)=2.2864;o1(1)=0.091;a2(1)=59.7136;o2(1)=3.9182
            CASE("Sm")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8542;o1(5)=0.3016;a2(5)=56.1458;o2(5)=7.5094
              a1(4)=2.7165;o1(4)=0.2413;a2(4)=57.2835;o2(4)=6.6781
              a1(3)=2.5361;o1(3)=0.178;a2(3)=58.4639;o2(3)=5.8004
              a1(2)=2.277;o1(2)=0.1096;a2(2)=59.723;o2(2)=4.8278
              a1(1)=2.278;o1(1)=0.0922;a2(1)=60.722;o2(1)=4.0487
            CASE("Eu")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8418;o1(5)=0.3083;a2(5)=57.1582;o2(5)=7.7706
              a1(4)=2.7052;o1(4)=0.2466;a2(4)=58.2948;o2(4)=6.9166
              a1(3)=2.5266;o1(3)=0.1818;a2(3)=59.4734;o2(3)=6.0156
              a1(2)=2.2697;o1(2)=0.1117;a2(2)=60.7303;o2(2)=5.0134
              a1(1)=2.2703;o1(1)=0.0934;a2(1)=61.7297;o2(1)=4.1829
            CASE("Gd")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8307;o1(5)=0.3319;a2(5)=58.1693;o2(5)=8.4743
              a1(4)=2.6951;o1(4)=0.2655;a2(4)=59.3049;o2(4)=7.5494
              a1(3)=2.5179;o1(3)=0.1956;a2(3)=60.4821;o2(3)=6.5735
              a1(2)=2.2654;o1(2)=0.1204;a2(2)=61.7346;o2(2)=5.4808
              a1(1)=2.2659;o1(1)=0.0948;a2(1)=62.7341;o2(1)=4.314
            CASE("Tb")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8206;o1(5)=0.3206;a2(5)=59.1794;o2(5)=8.2893
              a1(4)=2.686;o1(4)=0.2563;a2(4)=60.314;o2(4)=7.3904
              a1(3)=2.5118;o1(3)=0.189;a2(3)=61.4882;o2(3)=6.438
              a1(2)=2.2611;o1(2)=0.1162;a2(2)=62.7389;o2(2)=5.373
              a1(1)=2.2616;o1(1)=0.0962;a2(1)=63.7384;o2(1)=4.4476
            CASE("Dy")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.8116;o1(5)=0.3273;a2(5)=60.1884;o2(5)=8.5735
              a1(4)=2.6788;o1(4)=0.2619;a2(4)=61.3212;o2(4)=7.6451
              a1(3)=2.5061;o1(3)=0.1931;a2(3)=62.4939;o2(3)=6.6664
              a1(2)=2.257;o1(2)=0.1185;a2(2)=63.743;o2(2)=5.5684
              a1(1)=2.2574;o1(1)=0.0976;a2(1)=64.7426;o2(1)=4.5835
            CASE("Ho")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.804;o1(5)=0.3342;a2(5)=61.196;o2(5)=8.8596
              a1(4)=2.6722;o1(4)=0.2674;a2(4)=62.3278;o2(4)=7.9054
              a1(3)=2.5008;o1(3)=0.197;a2(3)=63.4992;o2(3)=6.8996
              a1(2)=2.2531;o1(2)=0.1208;a2(2)=64.7469;o2(2)=5.7681
              a1(1)=2.2535;o1(1)=0.0989;a2(1)=65.7465;o2(1)=4.7218
            CASE("Er")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7969;o1(5)=0.3412;a2(5)=62.2031;o2(5)=9.1533
              a1(4)=2.6662;o1(4)=0.273;a2(4)=63.3338;o2(4)=8.1729
              a1(3)=2.4958;o1(3)=0.201;a2(3)=64.5042;o2(3)=7.1389
              a1(2)=2.2493;o1(2)=0.1231;a2(2)=65.7507;o2(2)=5.9726
              a1(1)=2.2497;o1(1)=0.1002;a2(1)=66.7503;o2(1)=4.8619
            CASE("Tm")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7905;o1(5)=0.3483;a2(5)=63.2095;o2(5)=9.4578
              a1(4)=2.6606;o1(4)=0.2786;a2(4)=64.3394;o2(4)=8.4503
              a1(3)=2.4913;o1(3)=0.2051;a2(3)=65.5087;o2(3)=7.3869
              a1(2)=2.2457;o1(2)=0.1255;a2(2)=66.7543;o2(2)=6.184
              a1(1)=2.2461;o1(1)=0.1014;a2(1)=67.7539;o2(1)=5.0042
            CASE("Yb")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=2.7847;o1(5)=0.3553;a2(5)=64.2153;o2(5)=9.7631
              a1(4)=2.6555;o1(4)=0.284;a2(4)=65.3445;o2(4)=8.7281
              a1(3)=2.4871;o1(3)=0.2091;a2(3)=66.5129;o2(3)=7.6354
              a1(2)=2.2424;o1(2)=0.1278;a2(2)=67.7576;o2(2)=6.3961
            CASE("Lu")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7794;o1(5)=0.3133;a2(5)=65.2206;o2(5)=8.7121
              a1(4)=2.6508;o1(4)=0.2504;a2(4)=66.3492;o2(4)=7.793
              a1(3)=2.4832;o1(3)=0.1842;a2(3)=67.5168;o2(3)=6.8219
              a1(2)=2.5665;o1(2)=0.1379;a2(2)=68.4335;o2(2)=5.6125
              a1(1)=2.8631;o1(1)=0.1305;a2(1)=69.1369;o2(1)=4.7416
            CASE("Hf")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7746;o1(5)=0.3633;a2(5)=66.2254;o2(5)=10.2254
              a1(4)=2.6467;o1(4)=0.2903;a2(4)=67.3533;o2(4)=9.1515
              a1(3)=2.8526;o1(3)=0.2478;a2(3)=68.1474;o2(3)=8.0926
              a1(2)=2.9254;o1(2)=0.1886;a2(2)=69.0746;o2(2)=6.7894
              a1(1)=3.2523;o1(1)=0.1594;a2(1)=69.7477;o2(1)=5.1754
            CASE("Ta")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=2.7701;o1(5)=0.3633;a2(5)=67.2299;o2(5)=10.3507
              a1(4)=2.9651;o1(4)=0.3255;a2(4)=68.0349;o2(4)=9.3122
              a1(3)=3.1148;o1(3)=0.2756;a2(3)=68.8852;o2(3)=8.2033
              a1(2)=3.0825;o1(2)=0.2064;a2(2)=69.9175;o2(2)=6.8326
              a1(1)=3.3633;o1(1)=0.1764;a2(1)=70.6367;o2(1)=5.3185
            CASE("W ")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.0474;o1(5)=0.4043;a2(5)=67.9526;o2(5)=10.6188
              a1(4)=3.2065;o1(4)=0.3599;a2(4)=68.7935;o2(4)=9.5395
              a1(3)=3.2849;o1(3)=0.3015;a2(3)=69.7151;o2(3)=8.3582
              a1(2)=3.1142;o1(2)=0.22;a2(2)=70.8858;o2(2)=6.8652
              a1(1)=3.3385;o1(1)=0.1868;a2(1)=71.6615;o2(1)=5.3621
            CASE("Re")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.2683;o1(5)=0.4415;a2(5)=68.7317;o2(5)=10.847
              a1(4)=3.3821;o1(4)=0.3902;a2(4)=69.6179;o2(4)=9.723
              a1(3)=3.3812;o1(3)=0.3231;a2(3)=70.6188;o2(3)=8.4704
              a1(2)=3.071;o1(2)=0.2287;a2(2)=71.929;o2(2)=6.8655
              a1(1)=3.2274;o1(1)=0.1932;a2(1)=72.7726;o2(1)=5.3922
            CASE("Os")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.4393;o1(5)=0.4751;a2(5)=69.5607;o2(5)=11.0421
              a1(4)=3.5017;o1(4)=0.4168;a2(4)=70.4983;o2(4)=9.8737
              a1(3)=3.4201;o1(3)=0.3409;a2(3)=71.5799;o2(3)=8.5578
              a1(2)=3.0448;o1(2)=0.238;a2(2)=72.9552;o2(2)=6.9215
              a1(1)=3.1725;o1(1)=0.2;a2(1)=73.8275;o2(1)=5.4492
            CASE("Ir")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.5658;o1(5)=0.5056;a2(5)=70.4342;o2(5)=11.2105
              a1(4)=3.5744;o1(4)=0.4402;a2(4)=71.4256;o2(4)=10.0017
              a1(3)=3.4493;o1(3)=0.3578;a2(3)=72.5507;o2(3)=8.666
              a1(2)=2.9899;o1(2)=0.245;a2(2)=74.0101;o2(2)=6.9803
              a1(1)=3.0922;o1(1)=0.205;a2(1)=74.9078;o2(1)=5.5085
            CASE("Pt")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.6534;o1(5)=0.5332;a2(5)=71.3466;o2(5)=11.3596
              a1(4)=3.6308;o1(4)=0.4626;a2(4)=72.3692;o2(4)=10.1408
              a1(3)=3.4451;o1(3)=0.3723;a2(3)=73.5549;o2(3)=8.7657
              a1(2)=2.917;o1(2)=0.2504;a2(2)=75.083;o2(2)=7.0486
              a1(1)=2.9977;o1(1)=0.2087;a2(1)=76.0023;o2(1)=5.5756
            CASE("Au")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.7229;o1(5)=0.5596;a2(5)=72.2771;o2(5)=11.5163
              a1(4)=3.6563;o1(4)=0.4825;a2(4)=73.3437;o2(4)=10.2689
              a1(3)=3.4151;o1(3)=0.3847;a2(3)=74.5849;o2(3)=8.8641
              a1(2)=2.8348;o1(2)=0.2542;a2(2)=76.1652;o2(2)=7.1313
              a1(1)=2.8978;o1(1)=0.2113;a2(1)=77.1022;o2(1)=5.6538
            CASE("Hg")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=3.7651;o1(5)=0.6622;a2(5)=73.2349;o2(5)=13.2283
              a1(4)=3.6558;o1(4)=0.5673;a2(4)=74.3442;o2(4)=11.7872
              a1(3)=3.366;o1(3)=0.4481;a2(3)=75.634;o2(3)=10.1709
              a1(2)=2.7495;o1(2)=0.2915;a2(2)=77.2505;o2(2)=8.2014
            CASE("Tl")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.7832;o1(5)=0.6767;a2(5)=74.2168;o2(5)=13.1862
              a1(4)=3.6343;o1(4)=0.5762;a2(4)=75.3657;o2(4)=11.7477
              a1(3)=3.3037;o1(3)=0.4511;a2(3)=76.6963;o2(3)=10.1417
              a1(2)=2.9273;o1(2)=0.2416;a2(2)=78.0727;o2(2)=7.9392
              a1(1)=3.6409;o1(1)=0.1601;a2(1)=78.3591;o2(1)=5.516
            CASE("Pb")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.7811;o1(5)=0.6599;a2(5)=75.2189;o2(5)=12.5949
              a1(4)=3.5964;o1(4)=0.5586;a2(4)=76.4036;o2(4)=11.2239
              a1(3)=3.8769;o1(3)=0.4132;a2(3)=77.1231;o2(3)=10.0686
              a1(2)=4.0789;o1(2)=0.2949;a2(2)=77.9211;o2(2)=8.7751
              a1(1)=4.9009;o1(1)=0.2225;a2(1)=78.0991;o2(1)=6.6473
            CASE("Bi")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=3.7621;o1(5)=0.6436;a2(5)=76.2379;o2(5)=12.0795
              a1(4)=4.3077;o1(4)=0.5355;a2(4)=76.6923;o2(4)=11.3134
              a1(3)=4.8535;o1(3)=0.4451;a2(3)=77.1465;o2(3)=10.565
              a1(2)=5.2033;o1(2)=0.3506;a2(2)=77.7967;o2(2)=9.5276
              a1(1)=6.0759;o1(1)=0.2982;a2(1)=77.9241;o2(1)=7.7567
            CASE("Po")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=4.5521;o1(5)=0.6651;a2(5)=76.4479;o2(5)=12.8796
              a1(4)=5.2684;o1(4)=0.5921;a2(4)=76.7316;o2(4)=12.356
              a1(3)=5.8858;o1(3)=0.5139;a2(3)=77.1142;o2(3)=11.6935
              a1(2)=6.081;o1(2)=0.4145;a2(2)=77.919;o2(2)=10.4605
              a1(1)=6.9215;o1(1)=0.3462;a2(1)=78.0785;o2(1)=8.4735
            CASE("At")
              LREF_CHG(1:5)=.TRUE.
              a1(5)=5.5268;o1(5)=0.729;a2(5)=76.4732;o2(5)=13.9816
              a1(4)=6.2897;o1(4)=0.6644;a2(4)=76.7103;o2(4)=13.519
              a1(3)=6.842;o1(3)=0.5887;a2(3)=77.158;o2(3)=12.7918
              a1(2)=7.021;o1(2)=0.4852;a2(2)=77.979;o2(2)=11.4823
              a1(1)=6.3975;o1(1)=0.3458;a2(1)=79.6025;o2(1)=9.0442
            CASE("Rn")
              LREF_CHG(2:5)=.TRUE.
              a1(5)=6.5582;o1(5)=0.7235;a2(5)=76.4418;o2(5)=13.6239
              a1(4)=7.3085;o1(4)=0.6723;a2(4)=76.6915;o2(4)=13.2297
              a1(3)=7.8211;o1(3)=0.5977;a2(3)=77.1789;o2(3)=12.4817
              a1(2)=8.0052;o1(2)=0.5034;a2(2)=77.9948;o2(2)=11.2696
            CASE DEFAULT
              CALL vtutor%error("ERROR(def_param): parameters for species " // flag // "not &
                 &available")
           END SELECT

           IF (charge>=0.) THEN
             oxmax=INT(charge)+1
             oxmin=oxmax-1
             IF (charge>3.) THEN
               oxmax=3
               oxmin=2
             ENDIF
           ELSE
             oxmax=0
             oxmin=-1
           ENDIF

           f=oxmax*1._q-charge
           !indx1=oxmin+2;indx2=oxmax+2
           indx2=oxmin+2;indx1=oxmax+2
                    
           !c compute C6 and R0 if needed
           IF (LallPARAM) THEN
             CALL give_alpha0(a1(2),a2(2),o1(2),o2(2),0._q,alpha0)
             CALL give_alpha(a1(indx1),a2(indx1),a1(indx2),a2(indx2),o1(indx1),o2(indx1),&
             & o1(indx2),o2(indx2),f,0._q,alpha)
             alpha=alpha*relvol
             CALL give_c6(a1(indx1),a2(indx1),a1(indx2),a2(indx2),o1(indx1),o2(indx1),&
             & o1(indx2),o2(indx2),f,c6)
             c6=c6*relvol*relvol
             r0new=r0*(alpha/alpha0)**0.33333333333333333
           ENDIF 
           
           !c determine freq-dependent polarizability
           CALL give_alpha(a1(indx1),a2(indx1),a1(indx2),a2(indx2),o1(indx1),o2(indx1),&
           & o1(indx2),o2(indx2),f,omega,alpha)
           alpha=alpha*relvol
                         
           
!            IF (IU6>=0) THEN
!              !write(*,*) flag,oxmax,oxmin,charge,f
!              write(*,*) flag,indx2,a1(indx2),a2(indx2),o1(indx2),o2(indx2)
!            ENDIF
         END SUBROUTINE DEF_PARAM

       END MODULE tim_parameters

